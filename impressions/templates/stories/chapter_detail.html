{% extends "base.html" %}
{% load staticfiles %}

{% block title %}{{ object.content_type.singular_title}}: {{object.title }} - {{ chapter.chapter_num }} {{ chapter.title|safe }} {% endblock %}

<!-- possibley migrate the following to a common story template -->
{% block stylesheets %}
  {{ block.super }}
  <style>
    .image-panel { background-image: url("{% static 'stories/' %}{{ object.slug }}/{{ chapter.image_name }}.jpg"); }
  </style>
{% endblock stylesheets %}

{% block wrapper_class %}"content-wrapper-wide"{% endblock wrapper_class %}


{% block content_area %}
  <div class="table-cell content-wrapper--narrative">
    <section class="image-panel">
      <p class="image-panel--caption">{{ chapter.caption|safe }}</p>

      <p class="go-to-deeper"><a href="">Dig Deeper</a></p>

    </section>

    <article class="table-cell text-panel chapter-text">
      <h4>{{ object.title|safe }}</h4>  
      <h2 class="story-subtitle">Chapter {{ chapter.chapter_num }}: {{ chapter.title|safe }}</h2> 

      <div class="chapter-text--scroll">
        {{ chapter.narrative|safe }}
      </div><!--/chapter-text-scroll-->


      <nav  class="chapter-nav">
        <ul>
          {% if chapter.get_prev %}
            <li><a href="{% url 'stories:chapter_detail' object.slug chapter.get_prev.chapter_num %}"> 
              &lArr; Previous</a></li>
          {% else %}
            <li>&lArr; Previous</li>
          {% endif %}
          <li>&diams;</li>

          {% if chapter.get_next %}
            <li><a href="{% url 'stories:chapter_detail' object.slug chapter.get_next.chapter_num %}">Next &rArr;</a></li>
          {% else %}
            Next &rArr;
          {% endif %}
         </ul>
          {% if chapter.get_next %}
            <p>Next chapter: <em>{{ chapter.get_next.title|safe }}</em></p>          
          {% endif %}   
      </nav>

    </article><!--/text-panel-->
  </div><!--/content-wrapper-narrative-->

  <div class="deeper table-cell">
    <h2>Dig&nbsp;Deeper</h2>
    <div class="table deeper toprow">

      <div class="deeper-row">
      {% for person in chapter.people.all %}
        <div class="table-cell">
          <a class="pop_item" href="{% url 'supporting:person_detail' person.slug %}">
          <img class="oval" src="{% static 'supporting/person/menupics/' %}{{ person.slug }}.jpg" alt="image of {{ person.slug}}">
            {{ person.first_name }} {{ person.middle_name }} {{ person.last_name }}
          </a>
        </div>
      {% endfor %}
      </div><!-- </deeper-row>-->
    </div><!-- </table deeper toprow>-->

    <div class="table deeper">
      <div class="deeper-row">
      {% for evidenceitem in chapter.evidence.all %}
        <div class="table-cell">
          <a class="pop_item"  href="{% url 'supporting:evidenceitem_detail' evidenceitem.slug %}">
          <img src="{% static 'supporting/evidenceitem/menupics/' %}{{ evidenceitem.slug }}.jpg" alt="image of {{ evidenceitem.slug }}">
            {{ evidenceitem.title }}
          </a>
        </div>
      {% endfor %}

      {% for context in chapter.contexts.all %}
        <div class="table-cell">
          <a class="pop_item" href="{% url 'supporting:context_detail' context.slug %}">
          <img src="{% static 'supporting/context/menupics/' %}{{ context.slug }}.jpg" alt="image of {{ context.slug }}">
            {{ context.title }}
          </a>
        </div>
      {% endfor %}
      </div><!-- </deeper-row>-->
    </div><!-- </table deeper>-->
  </div><!--/deeper table-cell-->
    
{% endblock content_area %}
